# Test configuration for unified BareboxTestStrategy
# This config demonstrates the strategy working with barebox-bringup (no pytest)
#
# Usage:
#   barebox-bringup -c examples/test-unified-strategy.yaml
#
# Expected behavior:
#   - Strategy imported without pytest (PYTEST_AVAILABLE=False)
#   - BareboxDriver binding is None (protocol-only mode)
#   - Clean transition to barebox state
#   - Console access without BareboxDriver automation

targets:
  main:
    drivers:
      # QEMU driver (acts as console and power)
      QEMUDriver:
        qemu_bin: qemu-system-aarch64
        machine: virt,highmem=off
        cpu: cortex-a57
        memory: 1024M
        kernel: barebox-dt-2nd.img
        extra_args: ""

      # Unified strategy from barebox/test/strategy.py
      # Should work without BareboxDriver (protocol-only mode)
      BareboxTestStrategy: {}

image-sets:
  default:
    barebox-dt-2nd.img: !template "$LG_BUILDDIR/images/barebox-dt-2nd.img"

# Import unified strategy from barebox repo
imports:
  - /home/sascha/git/barebox/test/strategy.py
